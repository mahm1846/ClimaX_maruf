
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../install/">
      
      
        <link rel="next" href="../reference/pretrain/">
      
      <link rel="icon" href="../assets/images/climax-icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.13">
    
    
      
        <title>Usage - ClimaX</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ffa9267a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="climax" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ClimaX" class="md-header__button md-logo" aria-label="ClimaX" data-md-component="logo">
      
  <img src="../assets/images/climax-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ClimaX
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/ClimaX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/ClimaX
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ClimaX" class="md-nav__button md-logo" aria-label="ClimaX" data-md-component="logo">
      
  <img src="../assets/images/climax-icon.png" alt="logo">

    </a>
    ClimaX
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/ClimaX" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/ClimaX
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Usage
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pretraining" class="md-nav__link">
    Pretraining
  </a>
  
    <nav class="md-nav" aria-label="Pretraining">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pretrained-checkpoints" class="md-nav__link">
    Pretrained checkpoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#global-forecasting" class="md-nav__link">
    Global Forecasting
  </a>
  
    <nav class="md-nav" aria-label="Global Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation_1" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training_1" class="md-nav__link">
    Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regional-forecasting" class="md-nav__link">
    Regional Forecasting
  </a>
  
    <nav class="md-nav" aria-label="Regional Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation_2" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training_2" class="md-nav__link">
    Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/pretrain/" class="md-nav__link">
        Pretraining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/global_forecast/" class="md-nav__link">
        Global Forecasting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pretraining" class="md-nav__link">
    Pretraining
  </a>
  
    <nav class="md-nav" aria-label="Pretraining">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    Training
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pretrained-checkpoints" class="md-nav__link">
    Pretrained checkpoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#global-forecasting" class="md-nav__link">
    Global Forecasting
  </a>
  
    <nav class="md-nav" aria-label="Global Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation_1" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training_1" class="md-nav__link">
    Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regional-forecasting" class="md-nav__link">
    Regional Forecasting
  </a>
  
    <nav class="md-nav" aria-label="Regional Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation_2" class="md-nav__link">
    Data Preparation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training_2" class="md-nav__link">
    Training
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">¤</a></h1>
<h2 id="pretraining">Pretraining<a class="headerlink" href="#pretraining" title="Permanent link">¤</a></h2>
<h3 id="data-preparation">Data Preparation<a class="headerlink" href="#data-preparation" title="Permanent link">¤</a></h3>
<p>The code for downloading and preprocessing CMIP6 data is coming soon</p>
<h3 id="training">Training<a class="headerlink" href="#training" title="Permanent link">¤</a></h3>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>python src/climax/pretrain/train.py --config &lt;path/to/config&gt;
</code></pre></div>
For example, to pretrain ClimaX on MPI-ESM dataset on 8 GPUs use
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>python<span class="w"> </span>src/climax/pretrain/train.py<span class="w"> </span>--config<span class="w"> </span>configs/pretrain_climax.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span>--trainer.strategy<span class="o">=</span>ddp<span class="w"> </span>--trainer.devices<span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span>--trainer.max_epochs<span class="o">=</span><span class="m">100</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span>--data.batch_size<span class="o">=</span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span>--model.lr<span class="o">=</span>5e-4<span class="w"> </span>--model.beta_1<span class="o">=</span><span class="s2">&quot;0.9&quot;</span><span class="w"> </span>--model.beta_2<span class="o">=</span><span class="s2">&quot;0.95&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span>--model.weight_decay<span class="o">=</span>1e-5
</code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Make sure to update the paths of the data directories in the config files (or override them via the CLI).</p>
</div>
<h3 id="pretrained-checkpoints">Pretrained checkpoints<a class="headerlink" href="#pretrained-checkpoints" title="Permanent link">¤</a></h3>
<p>We provide two pretrained checkpoints, one was pretrained on <a href="https://climaxrelease.blob.core.windows.net/checkpoints/ClimaX-5.625deg.ckpt">5.625deg</a> data, and the other was pretrained on <a href="https://climaxrelease.blob.core.windows.net/checkpoints/ClimaX-1.40625deg.ckpt">1.40625deg</a> data. Both checkpoints were pretrained using all 5 CMIP6 datasets.</p>
<p><strong>Usage:</strong> We can load the checkpoint by passing the checkpoint url to the training script. See below for examples.</p>
<h2 id="global-forecasting">Global Forecasting<a class="headerlink" href="#global-forecasting" title="Permanent link">¤</a></h2>
<h3 id="data-preparation_1">Data Preparation<a class="headerlink" href="#data-preparation_1" title="Permanent link">¤</a></h3>
<p>First, download ERA5 data from <a href="https://dataserv.ub.tum.de/index.php/s/m1524895">WeatherBench</a>. The data directory should look like the following
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>5.625deg
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>   |-- 10m_u_component_of_wind
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>   |-- 10m_v_component_of_wind
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>   |-- 2m_temperature
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>   |-- constants.nc
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>   |-- geopotential
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>   |-- relative_humidity
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>   |-- specific_humidity
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>   |-- temperature
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>   |-- toa_incident_solar_radiation
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>   |-- total_precipitation
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>   |-- u_component_of_wind
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>   |-- v_component_of_wind
</code></pre></div></p>
<p>Then, preprocess the netcdf data into small numpy files and compute important statistics
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>python<span class="w"> </span>src/data_preprocessing/nc2np_equally_era5.py<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span>--root_dir<span class="w"> </span>/mnt/data/5.625deg<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span>--save_dir<span class="w"> </span>/mnt/data/5.625deg_npz<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span>--start_train_year<span class="w"> </span><span class="m">1979</span><span class="w"> </span>--start_val_year<span class="w"> </span><span class="m">2016</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span>--start_test_year<span class="w"> </span><span class="m">2017</span><span class="w"> </span>--end_year<span class="w"> </span><span class="m">2019</span><span class="w"> </span>--num_shards<span class="w"> </span><span class="m">8</span>
</code></pre></div></p>
<p>The preprocessed data directory will look like the following
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>5.625deg_npz
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>   |-- train
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>   |-- val
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>   |-- test
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>   |-- normalize_mean.npz
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>   |-- normalize_std.npz
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>   |-- lat.npy
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>   |-- lon.npy
</code></pre></div></p>
<h3 id="training_1">Training<a class="headerlink" href="#training_1" title="Permanent link">¤</a></h3>
<p>To finetune ClimaX for global forecasting, use
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>python src/climax/global_forecast/train.py --config &lt;path/to/config&gt;
</code></pre></div>
For example, to finetune ClimaX on 8 GPUs use
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>python<span class="w"> </span>src/climax/global_forecast/train.py<span class="w"> </span>--config<span class="w"> </span>configs/global_forecast_climax.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span>--trainer.strategy<span class="o">=</span>ddp<span class="w"> </span>--trainer.devices<span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span>--trainer.max_epochs<span class="o">=</span><span class="m">50</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span>--data.root_dir<span class="o">=</span>/mnt/data/5.625deg_npz<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span>--data.predict_range<span class="o">=</span><span class="m">72</span><span class="w"> </span>--data.out_variables<span class="o">=[</span><span class="s1">&#39;z_500&#39;</span>,<span class="s1">&#39;t_850&#39;</span>,<span class="s1">&#39;t2m&#39;</span><span class="o">]</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span>--data.batch_size<span class="o">=</span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span>--model.pretrained_path<span class="o">=</span><span class="s1">&#39;https://climaxrelease.blob.core.windows.net/checkpoints/ClimaX-5.625deg.ckpt&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span>--model.lr<span class="o">=</span>5e-7<span class="w"> </span>--model.beta_1<span class="o">=</span><span class="s2">&quot;0.9&quot;</span><span class="w"> </span>--model.beta_2<span class="o">=</span><span class="s2">&quot;0.99&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span>--model.weight_decay<span class="o">=</span>1e-5
</code></pre></div>
To train ClimaX from scratch, set <code>--model.pretrained_path=""</code>.</p>
<h2 id="regional-forecasting">Regional Forecasting<a class="headerlink" href="#regional-forecasting" title="Permanent link">¤</a></h2>
<h3 id="data-preparation_2">Data Preparation<a class="headerlink" href="#data-preparation_2" title="Permanent link">¤</a></h3>
<p>We use the same ERA5 data as in global forecasting and extract the regional data on the fly during training. If you have already downloaded and preprocessed the data, you do not have to do it again.</p>
<h3 id="training_2">Training<a class="headerlink" href="#training_2" title="Permanent link">¤</a></h3>
<p>To finetune ClimaX for regional forecasting, use
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>python src/climax/regional_forecast/train.py --config &lt;path/to/config&gt;
</code></pre></div>
For example, to finetune ClimaX on North America using 8 GPUs, use
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>python<span class="w"> </span>src/climax/regional_forecast/train.py<span class="w"> </span>--config<span class="w"> </span>configs/regional_forecast_climax.yaml<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span>--trainer.strategy<span class="o">=</span>ddp<span class="w"> </span>--trainer.devices<span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span>--trainer.max_epochs<span class="o">=</span><span class="m">50</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span>--data.root_dir<span class="o">=</span>/mnt/data/5.625deg_npz<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span>--data.region<span class="o">=</span><span class="s2">&quot;NorthAmerica&quot;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span>--data.predict_range<span class="o">=</span><span class="m">72</span><span class="w"> </span>--data.out_variables<span class="o">=[</span><span class="s1">&#39;z_500&#39;</span>,<span class="s1">&#39;t_850&#39;</span>,<span class="s1">&#39;t2m&#39;</span><span class="o">]</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span>--data.batch_size<span class="o">=</span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span>--model.pretrained_path<span class="o">=</span><span class="s1">&#39;https://climaxrelease.blob.core.windows.net/checkpoints/ClimaX-5.625deg.ckpt&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span>--model.lr<span class="o">=</span>5e-7<span class="w"> </span>--model.beta_1<span class="o">=</span><span class="s2">&quot;0.9&quot;</span><span class="w"> </span>--model.beta_2<span class="o">=</span><span class="s2">&quot;0.99&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">    </span>--model.weight_decay<span class="o">=</span>1e-5
</code></pre></div>
To train ClimaX from scratch, set <code>--model.pretrained_path=""</code>.</p>
<h2 id="visualization">Visualization<a class="headerlink" href="#visualization" title="Permanent link">¤</a></h2>
<p>Coming soon</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
    
  </body>
</html>